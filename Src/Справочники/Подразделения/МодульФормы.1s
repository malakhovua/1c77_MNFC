Перем ЭтоНовыйЭлемент;
Перем дСтараяДатаНачалаДействия;

// ===============================
Процедура ИзмДатаНачалаДействия()
КонецПроцедуры

// ===============================
Процедура ИзмТипПодразделения()
	Если ТипПодразделения <>  Перечисление.ТипыПодразделений.Производственное Тогда
        СкладГотовойПродукции = 0;
    КонецЕсли;
КонецПроцедуры

// ===============================
Процедура ВводНового(ПризнакКопирования)
	Если ПризнакКопирования = 1 Тогда
	    Возврат;
	КонецЕсли;
	
	ЭтоНовыйЭлемент = 1;
	Если Родитель.Выбран() = 1 Тогда
		ДатаНачалаДействия = Родитель.ДатаНачалаДействия;
	Иначе
		ДатаНачалаДействия = РабочаяДата();
	КонецЕсли;
	
КонецПроцедуры

// ===============================
Процедура ПриОткрытии()
	дСтараяДатаНачалаДействия = ДатаНачалаДействия;
КонецПроцедуры

// ===============================
Процедура ПриЗаписи()
	
	Если ПустоеЗначение(ТипПодразделения)=1 Тогда
		Предупреждение("Не задан тип подразделения!");
		Активизировать("ТипПодразделения");
		СтатусВозврата(0);
		Возврат;
	КонецЕсли;
	
	Если ПустоеЗначение(ДатаНачалаДействия)=1 Тогда
		Предупреждение("Укажите дату формирования!");
		Активизировать("ДатаНачалаДействия");
		СтатусВозврата(0);
		Возврат;
	КонецЕсли;
	
	Если (ПустоеЗначение(ДатаОкончанияДействия)=0) и
		(ДатаОкончанияДействия<ДатаНачалаДействия) Тогда
		Предупреждение("Подразделение не может быть расформировано до даты формирования!");
		Активизировать("ДатаОкончанияДействия");
		СтатусВозврата(0);
		Возврат;
	КонецЕсли;
	
	//--- УМК Сандомирский В.Ю, Закоментил 24.04.14
	//глОтправитьУведомлениеЭП("Справочник.Подразделения", "Подразделения: уведомление об изменении", ?(ТекущийЭлемент().Выбран() = 1, "Изменен","Добавлен новый") + " элемент справочника Подразделения: " + Наименование + " пользователь: " + Строка(глПользователь));

КонецПроцедуры

// ===============================
Функция УстДоступность()
    Если ТипПодразделения = Перечисление.ТипыПодразделений.Производственное Тогда
        Форма.СкладГотовойПродукции.Доступность(1);
	Иначе
		Форма.СкладГотовойПродукции.Доступность(0);
    КонецЕсли;
КонецФункции //УстДоступность

ЭтоНовыйЭлемент=0;